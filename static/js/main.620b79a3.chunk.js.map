{"version":3,"sources":["App.js","index.js"],"names":["baseData","accounts","totals","nbr","cash","invested","total","baseURL","Accounts","_ref","react_default","a","createElement","map","item","key","accID","p2p","bal","toFixed","acrincluded","loanbal","int","useDataApi","initialUrl","initialData","_useState","useState","_useState2","Object","slicedToArray","data","setData","_useState3","_useState4","isLoading","setIsLoading","_useState5","_useState6","isError","setIsError","fetchData","_ref2","asyncToGenerator","regenerator_default","mark","_callee","url","result","wrap","_context","prev","next","axios","get","headers","Authorization","fakeAuth","JWT","x-api-key","sent","t0","stop","_x","apply","this","arguments","useEffect","isAuthenticated","authenticate","token","cb","setTimeout","signout","AuthButton","withRouter","_ref3","history","onClick","push","PrivateRoute","_ref4","Component","component","rest","objectWithoutProperties","react_router","assign","render","props","to","pathname","state","from","location","Public","Protected","_useDataApi","event","preventDefault","type","Login","redirectToReferrer","login","_this","setState","hash","match","App","react_router_dom","path","ReactDOM","src_App","document","getElementById"],"mappings":"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","file":"static/js/main.620b79a3.chunk.js","sourcesContent":["import React, { Component, useState, useEffect } from \"react\";\nimport { BrowserRouter as Router,  Route,  Link,  Redirect,  withRouter } from \"react-router-dom\";\nimport axios from \"axios\";\n\n//const loginURL = 'https://p2p.auth.us-east-2.amazoncognito.com/login?client_id=tm9on3tnnq6enqt3b48hsmo1m&redirect_uri=https://www.arloesol.com/login_callback&response_type=token';\nconst apiKey = \"XQdMDLtost94GvFow0AqT416sHTMisj17Xak7JgI\";\nconst baseData = { \"accounts\": [], \"totals\": { \"nbr\" : 0, \"cash\": 0, \"invested\": 0, \"total\" : 0 }};\n\n// API URL\n// DEV\n// const baseURL = \"http://awscl9.arloesol.com:8080/api\";\n// PROD\nconst baseURL = \"https://5q3g7nxt47.execute-api.us-east-2.amazonaws.com/Prod/api\";\n\nfunction Accounts({ accounts }) {\n  return(\n          <ul>\n          {accounts.map(item => (\n            <li key={item.accID}>\n              {item.p2p} : {item.bal.cash.toFixed(2)} - {(item.bal.total + (item.bal.acrincluded ? 0 : item.loanbal.int)).toFixed(2)}\n            </li>\n          ))}\n        </ul>);\n}\n\nconst useDataApi = (initialUrl, initialData) => {\n  const [data, setData] = useState(initialData);\n  const [isLoading, setIsLoading] = useState(false);\n  const [isError, setIsError] = useState(false);\n\n  const fetchData = async (url) => {\n    setIsError(false);\n    setIsLoading(true);\n\n    try {\n      const result = await axios.get(url,  { headers: { \"Authorization\": \"Bearer \" + fakeAuth.JWT, \"x-api-key\": apiKey } });\n      setData(result.data);\n    } catch (error) {\n      setData(baseData);\n      setIsError(true);\n    }\n\n    setIsLoading(false);\n  };\n\n  useEffect(\n    () => {\n      fetchData(initialUrl, fakeAuth.JWT);\n    },\n    [initialUrl]\n  );\n\n  return { data, isLoading, isError, fetchData };\n};\n\nfunction App() {\n  return (\n    <Router>\n      <div>\n        <AuthButton />\n        <ul>\n          <li>\n            <Link to=\"/public\">Public Page</Link>\n          </li>\n          <li>\n            <Link to=\"/protected\">Protected Page</Link>\n          </li>\n        </ul>\n        <Route path=\"/public\" component={Public} />\n        <Route path=\"/login\" component={Login} />\n        <PrivateRoute path=\"/protected\" component={Protected} />\n      </div>\n    </Router>\n  );\n}\n\nconst fakeAuth = {\n  isAuthenticated: false,\n  JWT: '',\n  authenticate(token, cb) {\n    this.isAuthenticated = true;\n    this.JWT = token;\n    setTimeout(cb, 100); // fake async\n  },\n  signout(cb) {\n    this.isAuthenticated = false;\n    this.JWT = '';\n    setTimeout(cb, 100);\n  }\n};\n\nconst AuthButton = withRouter(\n  ({ history }) =>\n    fakeAuth.isAuthenticated ? (\n      <p>\n        Welcome!{\" \"}\n        <button\n          onClick={() => {\n            fakeAuth.signout(() => history.push(\"/\"));\n          }}\n        >\n          Sign out\n        </button>\n      </p>\n    ) : (\n      <p>You are not logged in.</p>\n    )\n);\n\nfunction PrivateRoute({ component: Component, ...rest }) {\n  return (\n    <Route\n      {...rest}\n      render={props =>\n        fakeAuth.isAuthenticated ? (\n          <Component {...props} />\n        ) : (\n          <Redirect\n            to={{\n              pathname: \"/login\",\n              state: { from: props.location }\n            }}\n          />\n        )\n      }\n    />\n  );\n}\n\nfunction Public() {\n  return <h3>Public</h3>;\n}\n\nfunction Protected() {\nconst { data, isLoading, isError, fetchData } = useDataApi(\n    baseURL + \"/p2ps\",\n    baseData\n  );\n  return  (<div>\n      <h3>Protected</h3>\n        <button onClick={event => {\n          var url = baseURL + '/p2ps?refreshAccounts=true&refreshLoans=true';\n          fetchData(url);\n          event.preventDefault();\n        }}>Refresh Data</button>\n        <br></br>\n        <button type=\"submit\">Get P2P balances</button>\n      {isError && <div>Something went wrong ...</div>}\n      {isLoading ? (\n        <div>Loading ...</div>\n      ) : (\n      <Accounts accounts={data.accounts}>\n      </Accounts>\n      )}\n    </div>);\n}\n\nclass Login extends Component {\n  state = { redirectToReferrer: false };\n  JWT = ''\n\n  login = (token) => {\n    fakeAuth.authenticate(token,() => {\n      this.setState({ redirectToReferrer: true });\n    });\n  };\n\n  render() {\n    let JWT = this.props.location.hash.match(/id_token=([^&]*)&/)[1];\n    let { from } = this.props.location.state || { from: { pathname: \"/\" } };\n    let { redirectToReferrer } = this.state;\n\n    if (redirectToReferrer) return <Redirect to={from} />;\n\n    return (\n      <div>\n        <p>You must log in to view the page at {from.pathname}</p>\n        <button onClick={this.login(JWT)}>Log in</button>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}